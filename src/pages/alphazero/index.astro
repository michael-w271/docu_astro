---
import Layout from '../../layouts/Layout.astro';
const base = import.meta.env.BASE_URL;
const repo = 'https://github.com/michael-w271/alphazerolight';
---

<Layout
  title="AlphaZero - Connect Four Overview"
  description="Technical overview of AlphaZeroLight for Connect Four: baseline champion results, week-long high-compute training, architecture, reliability fixes, and evaluation tooling."
>
  <div style="max-width: 1100px; margin: 0 auto; padding: 3rem 1.5rem;">
    <div style="margin-bottom: 2.5rem;">
      <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
        <span class="tag tag-green">AlphaZero</span>
        <span class="tag tag-blue">MCTS</span>
        <span class="tag tag-purple">ResNet</span>
        <span class="tag">Connect Four</span>
      </div>
      <h1 style="font-size: 2.8rem; font-weight: 800; margin-bottom: 1rem;">
        AlphaZero
        <span class="gradient-text" style="display: block; font-size: 0.72em; margin-top: 0.2rem;">
          Connect Four (4 in a row)
        </span>
      </h1>
      <p style="color: var(--text-secondary); font-size: 1.18rem; max-width: 840px; line-height: 1.7;">
        This project started as a short reproducible AlphaZero benchmark and evolved into a long,
        high-compute training campaign. The baseline run produced a tournament champion
        (`model_120`), and the later extended run (week-scale) pushed the agent to a level that is
        very hard to beat consistently in human play.
      </p>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1rem; margin-bottom: 2.5rem;">
      <div class="stat-card" style="text-align: center;">
        <div style="font-size: 2rem; font-weight: 800; color: var(--accent-green);">30W-5D-15L</div>
        <div style="color: var(--text-secondary); font-size: 0.88rem; margin-top: 0.25rem;">`model_120` tournament record</div>
      </div>
      <div class="stat-card" style="text-align: center;">
        <div style="font-size: 2rem; font-weight: 800; color: var(--accent-blue);">model_195</div>
        <div style="color: var(--text-secondary); font-size: 0.88rem; margin-top: 0.25rem;">High-iteration checkpoint in head-to-head tooling</div>
      </div>
      <div class="stat-card" style="text-align: center;">
        <div style="font-size: 2rem; font-weight: 800; color: var(--accent-orange);">150-300</div>
        <div style="color: var(--text-secondary); font-size: 0.88rem; margin-top: 0.25rem;">Iterations for max-strength configuration</div>
      </div>
      <div class="stat-card" style="text-align: center;">
        <div style="font-size: 2rem; font-weight: 800; color: var(--accent-purple);">400</div>
        <div style="color: var(--text-secondary); font-size: 0.88rem; margin-top: 0.25rem;">MCTS searches per move (max run)</div>
      </div>
    </div>

    <section style="margin-bottom: 3rem;">
      <h2 style="font-size: 1.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
        What This Page Covers
      </h2>
      <div class="prose">
        <p>
          The public repo contains both baseline training artifacts and the infrastructure for much
          stronger long runs:
        </p>
        <ul>
          <li>Baseline tournament documentation in `docs/training/TRAINING_DOCUMENTATION.md`</li>
          <li>Maximum-strength plan in `docs/training/MAXIMUM_TRAINING_CONFIG.md`</li>
          <li>High-iteration comparison scripts such as `tests/integration/custom_tournament.py`</li>
          <li>Operational scripts for start/pause/resume, monitoring, and web play</li>
        </ul>
      </div>
      <div class="callout callout-info">
        <strong>Repository:</strong> <a href={repo} target="_blank" rel="noopener">{repo}</a>
      </div>
    </section>

    <section style="margin-bottom: 3rem;">
      <h2 style="font-size: 1.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
        Training Evolution
      </h2>

      <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1rem;">
        <div class="stat-card" style="border-left: 3px solid var(--accent-blue);">
          <h3 style="margin-bottom: 0.5rem; color: var(--accent-blue);">Phase 1: Baseline Champion</h3>
          <ul style="color: var(--text-secondary); font-size: 0.9rem; padding-left: 1.2rem;">
            <li>ResNet-10, 128 hidden channels (~1.2M params)</li>
            <li>100 MCTS searches per move</li>
            <li>127 iterations, ~24-32 hours total</li>
            <li>`model_120` won the round-robin tournament</li>
            <li>Standings top line: 30W-5D-15L (60% win rate)</li>
          </ul>
        </div>

        <div class="stat-card" style="border-left: 3px solid var(--accent-green);">
          <h3 style="margin-bottom: 0.5rem; color: var(--accent-green);">Phase 2: Week-Scale Run</h3>
          <ul style="color: var(--text-secondary); font-size: 0.9rem; padding-left: 1.2rem;">
            <li>ResNet-20, 256 hidden channels (~5M params)</li>
            <li>400 MCTS searches per move</li>
            <li>150-300 iteration target (~7-10 days)</li>
            <li>High-iteration checkpoints referenced up to `model_195`</li>
            <li>Human games became substantially harder to win</li>
          </ul>
        </div>
      </div>

      <div class="callout callout-success" style="margin-top: 1rem;">
        <strong>Interpretation:</strong> The early 50-iteration demo metrics (fast run) are useful as
        a sanity check, but the stronger gameplay came from the long high-search training campaign.
      </div>
    </section>

    <section style="margin-bottom: 3rem;">
      <h2 style="font-size: 1.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
        Why The Current Agent Is Hard To Beat
      </h2>
      <div class="prose">
        <ul>
          <li><strong>Deeper search:</strong> 400-search MCTS catches tactical threats that shallow play misses.</li>
          <li><strong>Larger backbone:</strong> ResNet-20/256 represents more long-range patterns and opening structure.</li>
          <li><strong>Expert iteration loop:</strong> Better network -> better MCTS -> better training targets -> better network.</li>
          <li><strong>Opponent diversity:</strong> Self-play plus aggressive/strong opponents improves robustness.</li>
          <li><strong>Temperature schedule:</strong> Early exploration plus later exploitation improves data quality.</li>
        </ul>
      </div>
    </section>

    <section style="margin-bottom: 3rem;">
      <h2 style="font-size: 1.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
        Architecture Snapshot
      </h2>

      <pre><code>
Input state: 3 x 6 x 7 (current player, opponent, empty/side channel)
      |
Start block: Conv + BatchNorm + ReLU
      |
Residual tower (10-20 blocks depending on config)
      |
   +--+----------------------+
   |                         |
Policy head                 Value head
7 action logits             Scalar in [-1, 1]
   |                         |
softmax(pi)                tanh(V)
      </code></pre>

      <div style="overflow-x: auto; margin-top: 1rem;">
        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
          <thead>
            <tr style="background: var(--bg-secondary);">
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Config</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">ResBlocks</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Hidden</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Approx Params</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Searches/Move</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Baseline</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">10</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">128</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">~1.2M</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">100</td>
            </tr>
            <tr style="background: var(--bg-secondary);">
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Max-strength</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">20</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">256</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">~5.0M</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">400</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section style="margin-bottom: 3rem;">
      <h2 style="font-size: 1.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
        Learning Loop And Tooling
      </h2>

      <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; margin: 1rem 0;">
        <div class="stat-card" style="border-top: 3px solid var(--accent-blue);">
          <div style="font-size: 0.8rem; color: var(--accent-blue); font-weight: 700; margin-bottom: 0.4rem;">STEP 1</div>
          <h3 style="margin-bottom: 0.5rem;">Self-play data</h3>
          <p style="color: var(--text-secondary); font-size: 0.9rem;">
            Generate `(state, pi, z)` tuples with MCTS-guided games. Use temperature and
            root-noise for controlled exploration.
          </p>
        </div>
        <div class="stat-card" style="border-top: 3px solid var(--accent-orange);">
          <div style="font-size: 0.8rem; color: var(--accent-orange); font-weight: 700; margin-bottom: 0.4rem;">STEP 2</div>
          <h3 style="margin-bottom: 0.5rem;">Train network</h3>
          <p style="color: var(--text-secondary); font-size: 0.9rem;">
            Optimize policy cross-entropy plus value MSE over replayed self-play batches.
          </p>
        </div>
        <div class="stat-card" style="border-top: 3px solid var(--accent-green);">
          <div style="font-size: 0.8rem; color: var(--accent-green); font-weight: 700; margin-bottom: 0.4rem;">STEP 3</div>
          <h3 style="margin-bottom: 0.5rem;">Evaluate and monitor</h3>
          <p style="color: var(--text-secondary); font-size: 0.9rem;">
            Run periodic tournaments/puzzles and inspect monitors for loss, win-rate, and regression.
          </p>
        </div>
      </div>

      <div class="callout callout-info">
        <strong>Operational support in repo:</strong> start/pause/resume scripts, checkpoint
        management, evaluation monitors, tactical tests, and Connect4 web lab integration.
      </div>
    </section>

    <section style="margin-bottom: 3rem;">
      <h2 style="font-size: 1.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
        Evaluation Evidence
      </h2>

      <div style="overflow-x: auto; margin-bottom: 1rem;">
        <table style="width: 100%; border-collapse: collapse; font-size: 0.88rem;">
          <thead>
            <tr style="background: var(--bg-secondary);">
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Rank</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Model</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">W-D-L</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Points</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Win%</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">1</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);"><strong>model_120</strong></td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">30-5-15</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">95</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">60%</td>
            </tr>
            <tr style="background: var(--bg-secondary);">
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">2</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">model_127</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">30-0-20</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">90</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">60%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="prose">
        <p>
          Later tooling in the same repo compares early and high-iteration checkpoints directly
          (for example `model_5` vs `model_195` in `tests/integration/custom_tournament.py`),
          which reflects the shift to stronger long-run training.
        </p>
      </div>
    </section>

    <section style="margin-bottom: 3rem;">
      <h2 style="font-size: 1.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
        Reliability Fixes That Unblocked Learning
      </h2>
      <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse; font-size: 0.88rem;">
          <thead>
            <tr style="background: var(--bg-secondary);">
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Issue</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Impact</th>
              <th style="padding: 0.65rem 0.8rem; border: 1px solid var(--border);">Fix</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Perspective encoding bug</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Inverted training signal for player -1</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Corrected board encoding logic</td>
            </tr>
            <tr style="background: var(--bg-secondary);">
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">UCB Q-sign bug</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Search favored opponent outcomes</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Negated child value correctly in parent UCB</td>
            </tr>
            <tr>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Duplicate memory extension</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Biased replay distribution</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Removed duplicate append path</td>
            </tr>
            <tr style="background: var(--bg-secondary);">
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">MCTS terminal-state handling</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Corrupted win/loss labels in search</td>
              <td style="padding: 0.6rem 0.8rem; border: 1px solid var(--border);">Terminal checks applied before perspective flip</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section style="margin-bottom: 2.5rem;">
      <h2 style="font-size: 1.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);">
        Deep-Dive Pages
      </h2>

      <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.2rem;">
        <a href={`${base}alphazero/mcts/`} style="text-decoration: none;">
          <div class="stat-card" style="border: 1px solid var(--border); cursor: pointer;"
               onmouseover="this.style.borderColor='var(--accent-blue)'"
               onmouseout="this.style.borderColor='var(--border)'">
            <div style="font-size: 0.9rem; font-weight: 700; color: var(--accent-blue); margin-bottom: 0.6rem;">TREE SEARCH</div>
            <h3 style="color: var(--accent-blue); margin-bottom: 0.5rem;">MCTS Deep Dive</h3>
            <p style="color: var(--text-secondary); font-size: 0.9rem;">
              PUCT formula, node bookkeeping, sign handling, root noise, and simulation scaling.
            </p>
          </div>
        </a>

        <a href={`${base}alphazero/network/`} style="text-decoration: none;">
          <div class="stat-card" style="border: 1px solid var(--border); cursor: pointer;"
               onmouseover="this.style.borderColor='var(--accent-purple)'"
               onmouseout="this.style.borderColor='var(--border)'">
            <div style="font-size: 0.9rem; font-weight: 700; color: var(--accent-purple); margin-bottom: 0.6rem;">MODEL</div>
            <h3 style="color: var(--accent-purple); margin-bottom: 0.5rem;">Neural Network</h3>
            <p style="color: var(--text-secondary); font-size: 0.9rem;">
              ResNet backbone, policy/value heads, board encoding, and training loss design.
            </p>
          </div>
        </a>

        <a href={`${base}alphazero/training/`} style="text-decoration: none;">
          <div class="stat-card" style="border: 1px solid var(--border); cursor: pointer;"
               onmouseover="this.style.borderColor='var(--accent-green)'"
               onmouseout="this.style.borderColor='var(--border)'">
            <div style="font-size: 0.9rem; font-weight: 700; color: var(--accent-green); margin-bottom: 0.6rem;">PIPELINE</div>
            <h3 style="color: var(--accent-green); margin-bottom: 0.5rem;">Self-Play Training</h3>
            <p style="color: var(--text-secondary); font-size: 0.9rem;">
              End-to-end loop, replay data generation, schedules, and practical training controls.
            </p>
          </div>
        </a>
      </div>
    </section>

    <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 2rem;">
      <a href={`${base}background/mcts/`}
         style="padding: 0.7rem 1.4rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 6px; text-decoration: none; font-weight: 600;">
        MCTS Background
      </a>
      <a href={`${base}compare/`}
         style="padding: 0.7rem 1.4rem; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 6px; text-decoration: none; font-weight: 600;">
        Compare with Tetris DQN
      </a>
    </div>
  </div>
</Layout>
